# NodeMCU 代码上传指南
## 📤 上传方法
### 方法一：使用 ESPlorer (推荐)
**1. 下载和启动 ESPlorer**
- 下载地址：https://esp8266.ru/esplorer/
- 需要Java运行环境
- 启动：`java -jar ESPlorer.jar`

**2. 连接设备**
- 用USB线连接NodeMCU到电脑
- 在ESPlorer中选择正确串口
- 波特率设置为 `115200`
- 点击 `Open` 连接

**3. 上传文件顺序 (很重要！)**

```
第一步：config.lua    ← 配置文件先上传
第二步：main.lua      ← 主程序文件
第三步：init.lua      ← 初始化文件最后上传
```

**为什么要按这个顺序？**
- `init.lua` 会在设备启动时自动执行
- 它会加载 `config.lua` 和 `main.lua`
- 如果先上传 `init.lua`，会因为找不到其他文件而报错

**4. 具体操作步骤**

1. **上传 config.lua**
   - 在ESPlorer右侧点击 `Open` 选择 `config.lua`
   - 点击 `Save to ESP` 或按 `F1`
   - 等待上传完成提示

2. **上传 main.lua**
   - 选择 `main.lua` 文件
   - 点击 `Save to ESP`
   - 等待上传完成

3. **上传 init.lua**
   - 选择 `init.lua` 文件
   - 点击 `Save to ESP`
   - **注意：上传后设备会自动重启并执行程序**
### 方法二：使用 NodeMCU-Tool (命令行)
**1. 安装工具**
```bash
npm install -g nodemcu-tool
```
**2. 上传文件**
```bash
# 进入项目目录
cd nodemcu/projects/led_control

# 按顺序上传文件
nodemcu-tool upload config.lua
nodemcu-tool upload main.lua  
nodemcu-tool upload init.lua

# 重启设备
nodemcu-tool reset
```

**3. 使用自动化脚本**

我们提供了自动化上传脚本，可以按正确顺序上传所有文件：

**Linux/macOS:**
```bash
chmod +x upload_script.sh
./upload_script.sh
```

**Windows:**
```cmd
upload_script.bat
```

脚本功能：
- 自动检查工具和文件
- 按 config.lua → main.lua → init.lua 顺序上传
- 错误处理和状态提示
- 自动重启设备
### 方法三：使用 ampy (Python工具)
**1. 安装 ampy**
```bash
pip install adafruit-ampy
```
**2. 上传文件**
```bash
# 设置串口环境变量 (替换为你的串口)
export AMPY_PORT=/dev/ttyUSB0  # Linux/macOS
# 或 set AMPY_PORT=COM3        # Windows

# 上传文件
ampy put config.lua
ampy put main.lua
ampy put init.lua

# 重启设备
ampy reset
```
