# 代码上传和调试指南

## 方法1: 使用Thonny IDE (推荐)

### 1. 安装Thonny IDE
- 下载: https://thonny.org/
- 安装后打开

### 2. 连接ESP8266
1. 打开Thonny IDE
2. 点击右下角的"Python版本" 
3. 选择"配置解释器..."
4. 选择"MicroPython (ESP8266)"
5. 端口选择: `/dev/tty.usbserial-110`
6. 点击"确定"

### 3. 上传代码
1. 打开要上传的文件 (如 `led_blink/src/main.py`)
2. 右键文件名 → "上传到 /"
3. 重复上传所有需要的文件:
   - `config.py`
   - `led_control.py`
   - `simple_led.py`
   - `main.py`

### 4. 运行和调试
```python
# 在Shell窗口中运行
exec(open('main.py').read())

# 或者直接运行代码
import led_control
led_control.led.on()
```

## 方法2: 使用命令行工具

### 1. 安装ampy
```bash
pip3 install adafruit-ampy
```

### 2. 上传文件
```bash
# 上传单个文件
ampy --port /dev/tty.usbserial-110 put led_blink/src/config.py

# 上传所有文件
cd led_blink/src
ampy --port /dev/tty.usbserial-110 put config.py
ampy --port /dev/tty.usbserial-110 put led_control.py
ampy --port /dev/tty.usbserial-110 put simple_led.py
ampy --port /dev/tty.usbserial-110 put main.py
```

### 3. 运行代码
```bash
# 运行程序
ampy --port /dev/tty.usbserial-110 run main.py

# 查看设备文件
ampy --port /dev/tty.usbserial-110 ls
```

## 方法3: 串口终端调试

### 1. 连接串口
```bash
screen /dev/tty.usbserial-110 115200
```

### 2. 交互式调试
```python
# 基本测试
import machine
led = machine.Pin(2, machine.Pin.OUT)

# 点亮LED
led.value(0)

# 熄灭LED
led.value(1)

# 闪烁测试
import time
for i in range(5):
    led.value(0)
    time.sleep(0.5)
    led.value(1)
    time.sleep(0.5)
```

## 调试技巧

### 1. 打印调试
```python
print("开始运行LED程序")
print(f"LED状态: {led.value()}")
```

### 2. 错误处理
```python
try:
    led.on()
    print("LED点亮成功")
except Exception as e:
    print(f"错误: {e}")
```

### 3. 查看设备信息
```python
import machine
print(f"频率: {machine.freq()}")
print(f"内存: {machine.mem_free()}")
```

### 4. 重启设备
```python
import machine
machine.reset()
```

## 常见问题

### 1. 连接失败
- 检查USB连接
- 确认端口正确: `/dev/tty.usbserial-110`
- 重启设备

### 2. 上传失败
- 确保设备已连接
- 检查文件路径正确
- 重试上传

### 3. 代码运行错误
- 检查语法错误
- 确认模块导入正确
- 查看错误信息

### 4. LED不亮
- 检查硬件连接
- 确认GPIO引脚正确 (GPIO2)
- 测试基本控制

## 快速测试脚本

创建 `test.py` 进行快速测试:
```python
import machine
import time

# 测试LED
led = machine.Pin(2, machine.Pin.OUT)
print("开始LED测试...")

# 闪烁3次
for i in range(3):
    print(f"闪烁 {i+1}/3")
    led.value(0)  # 点亮
    time.sleep(0.5)
    led.value(1)  # 熄灭
    time.sleep(0.5)

print("测试完成")
```